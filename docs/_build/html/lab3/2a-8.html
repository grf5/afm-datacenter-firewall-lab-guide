<!DOCTYPE html>
<head>
  
  <!--STAGING:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3-staging.js"></script>
  <!--Production:-->
  <script src="https://assets.adobedtm.com/50164577268f481934e5d57dbfb78f929164cd0d/satelliteLib-ea775cfabef5fca8b04e9392f20c986c0724a7c3.js"></script>
    <title>6.2.10. Bad Actor Detection</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="kb_doc_type" content="Manual"/>
  <meta name="kb_doc_type" content="User Guide"/>
  <meta name="title" content="6.2.10. Bad Actor Detection"/>
  <meta name="product" content="F5 BIG-IP AFM - The Data Center Firewall Lab"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="None"/>
  <meta name="archived" content="Archived documents excluded"/>

  
  
  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">
 
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script type="text"> jQuery.noConflict(true)</script>

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>6.2.10. Bad Actor Detection &#8212; F5 BIG-IP AFM - The Data Center Firewall Lab  documentation</title>
    <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/f5_agility_theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6.2.11. Remote Triggered Black Holing" href="2a-9.html" />
    <link rel="prev" title="6.2.9. DNS DDoS Mitigations for Continued Service" href="2a-7.html" />
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="dismiss">
      <button type="button" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>
    </div>
    <div id="sidebar" class="section-nav">
      <nav class="nav-sidebartoc">
        <h5>F5 BIG-IP AFM - The Data Center Firewall Lab  documentation </h5>
<div id="searchbox" role="search">
  <form class="search" action="../search.html" method="get">
    <input type="text" class="search" name="q" placeholder=" Search..." />
    <button type="submit" class="btn btn-info navbar-btn"><i class="fa fa-search"></i></button>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        <hr>
        <h5>Current Page</h5>
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">6.2.10. Bad Actor Detection</a></li>
</ul>

         </span>
        <hr>
        <h5>Site Contents</h5>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro1.html">1. Advanced Firewall Manager - The Data Center Firewall</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro2.html">2. Connecting to the Training Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro3.html">3. Ravello Environment Pre-Check</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab1/intro.html">4. Lab 1 – Advanced Firewall Manager (AFM)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab2/intro.html">5. Lab 2 - AFM Packet Tester, Flow Inspector, Stale Rule Lab</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="intro.html">6. Lab 3 - AFM DDoS Lab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab4/intro.html">7. Lab 4 - Device Management Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab5/intro.html">8. Lab 5 - Network Security (AFM) Management Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lab6/intro.html">9. Lab 6 - iControl REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conclusion.html">10. Conclusion</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>

  
  <div class="main active" id="content">
    <article class="docs-container site-article-inner">
            <nav class="site-breadcrumb-nav site-nav">
          <ul class="site-breadcrumb-list">
            <li class="breadcrumb-item"><button type="button" id="sidebarCollapse" class="btn btn-info navbar-btn site-hidden"><i class="fa fa-align-justify"></i></button>&#x20 <a href="/">Community Training Classes &amp; Labs</a> &gt; <a href="../index.html">F5 BIG-IP AFM - The Data Center Firewall Lab </a> &gt; 6.2.10. Bad Actor Detection</li>
          </ul>
      </nav>
      
      

    
  <div class="section" id="bad-actor-detection">
<h1>6.2.10. Bad Actor Detection<a class="headerlink" href="#bad-actor-detection" title="Permalink to this headline">¶</a></h1>
<p>Bad actor detection and blacklisting allows us to completely block
communications from malicious hosts at the BIG-IP, completely preventing
those hosts from reaching the back-end servers. To demonstrate:</p>
<ol class="arabic">
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong> &gt; <strong>DoS Profiles</strong>.</p>
</li>
<li><p class="first">Click on the <strong>dns-dos-profile</strong> profile name.</p>
</li>
<li><p class="first">Click on the <strong>Protocol Security</strong> tab then select <strong>DNS Security</strong>.</p>
</li>
<li><p class="first">Click on the <strong>DNS A Query</strong> attack type name.</p>
</li>
<li><p class="first">Modify the vector as follows:</p>
<ol class="loweralpha">
<li><p class="first">Bad Actor Detection: Checked</p>
</li>
<li><p class="first">Per Source IP Detection Threshold EPS: 80</p>
</li>
<li><p class="first">Per Source IP Mitigation Threshold EPS: 100</p>
</li>
<li><p class="first">Add Source Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 15 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Category Duration Time: 60 seconds</div>
<div class="line"><a class="reference internal" href="../_images/image60.png"><img alt="image62" src="../_images/image60.png" style="width: 2.67129in; height: 5.81457in;" /></a></div>
</div>
</li>
</ol>
</li>
<li><p class="first">Make sure you click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Network Firewall</strong> &gt; <strong>IP
Intelligence</strong> &gt; <strong>Policies</strong> and create a new IP Intelligence
policy with the following values, leaving unspecified attributes at
their default values:</p>
<ol class="loweralpha simple" start="8">
<li>Name: dns-bad-actor-blocking</li>
<li>Default Log Actions section:<ol class="lowerroman">
<li>Log Blacklist Category Matches: Yes</li>
</ol>
</li>
<li>Blacklist Matching Policy<ol class="lowerroman" start="2">
<li>Create a new blacklist matching policy:<ol class="arabic">
<li>Blacklist Category: denial_of_service</li>
<li><a class="reference internal" href="../_images/image61.png"><img alt="image63" src="../_images/image61.png" style="width: 6.22083in; height: 3.675in;" /></a>Click <strong>Add</strong> to add the policy then click
finished</li>
</ol>
</li>
</ol>
</li>
</ol>
</li>
<li><p class="first">Navigate to <strong>Local Traffic</strong> &gt; <strong>Virtual Servers</strong> &gt; <strong>Virtual
Server List</strong>.</p>
</li>
<li><p class="first">Click on the <strong>udp_dns_VS</strong> virtual server name.</p>
</li>
<li><p class="first">Click on the <strong>Security</strong> tab and select <strong>Policies</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">Enable <strong>IP Intelligence</strong> and choose the
<strong>dns-bad-actor-blocking</strong> policy.</div>
<div class="line"><a class="reference internal" href="../_images/image62.png"><img alt="image64" src="../_images/image62.png" style="width: 3.81074in; height: 5.31788in;" /></a></div>
</div>
</li>
<li><p class="first">Make sure you click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Logging Profiles</strong>.</p>
</li>
<li><p class="first">Click the <strong>global-network</strong> logging profile name.</p>
</li>
<li><div class="first line-block">
<div class="line">Under the <strong>Network Firewall</strong> tab (next to Protocol Security),
set the IP Intelligence Publisher to <strong>local-db-publisher</strong> and
check <strong>Log Shun Events</strong>.</div>
<div class="line"><a class="reference internal" href="../_images/image63.png"><img alt="image65" src="../_images/image63.png" style="width: 4.17881in; height: 2.18072in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Click the <strong>dns-dos-profile-logging</strong> logging profile name.</p>
</li>
<li><div class="first line-block">
<div class="line">Check <strong>Enabled</strong> next to <strong>Network Firewall</strong>.</div>
<div class="line"><a class="reference internal" href="../_images/image64.png"><img alt="image66" src="../_images/image64.png" style="width: 3.40297in; height: 3.22001in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">Under the <strong>Network Firewall</strong> tab, change the <strong>IP Intelligence
Publisher</strong> to <strong>local-db-publisher</strong> and click <strong>Update</strong>.</div>
<div class="line"><a class="reference internal" href="../_images/image65.png"><img alt="image67" src="../_images/image65.png" style="width: 2.96026in; height: 1.54149in;" /></a></div>
</div>
</li>
<li><p class="first">Bring into view the Victim Server SSH session running the top
utility to monitor CPU utilization.</p>
</li>
<li><div class="first line-block">
<div class="line">On the Attack Server host, launch the DNS attack once again using
the following syntax:</div>
<div class="line">dnsperf -s 10.20.0.10 -d queryfile-example-current -c 20 -T 20 -l
30 -q 10000 -Q 10000</div>
</div>
</li>
<li><div class="first line-block">
<div class="line">You’ll notice CPU utilization on the BIG-IP begin to climb, but
slowly drop. The attack host will show that queries are timing out
as shown below. This is due to the BIG-IP blacklisting the bad
actor.</div>
<div class="line"><a class="reference internal" href="../_images/image66.png"><img alt="image68" src="../_images/image66.png" style="width: 2.36111in; height: 0.68056in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the bad actor blocking mitigation logs.</p>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt;
<strong>Shun</strong>. This screen shows the bad actor being added to (and
later deleted from) the shun category.</div>
<div class="line"><a class="reference internal" href="../_images/image67.png"><img alt="image69" src="../_images/image67.png" style="width: 4.875in; height: 1.68056in;" /></a></div>
</div>
</li>
<li><p class="first">While the attack is running, navigate to <strong>Security</strong> &gt; <strong>DoS
Protection</strong>&gt; <strong>DoS Overview (you may need to refresh or set the
auto refresh to 10 seconds).</strong> You will notice from here you can see
all the details of the active attacks. You can also modify an attack
vector right from this screen by clicking on the attack vector and
modifying the fly out.</p>
</li>
</ol>
<p><a class="reference internal" href="../_images/image68.png"><img alt="image70" src="../_images/image68.png" style="width: 6.69121in; height: 3.10185in;" /></a></p>
<ol class="arabic" start="26">
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Protocol</strong> &gt; <strong>DNS</strong>.
Change the <strong>View By</strong> drop-down to view various statistics around
the DNS traffic and attacks.</div>
<div class="line"><a class="reference internal" href="../_images/image69.png"><img alt="image71" src="../_images/image69.png" style="width: 4.3245in; height: 3.69594in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. The default view may be blank. Change the <strong>View
By</strong> drop-down to view various statistics around the IP Intelligence
handling of the attack traffic.</p>
</li>
<li><div class="first line-block">
<div class="line">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can
select filters in the filter pane to highlight specific attacks.</div>
<div class="line"><a class="reference internal" href="../_images/image70.png"><img alt="image72" src="../_images/image70.png" style="width: 5in; height: 4.06944in;" /></a></div>
</div>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around each attack.</p>
</li>
</ol>
<p><a class="reference internal" href="../_images/image71.png"><img alt="image73" src="../_images/image71.png" style="width: 6.49097in; height: 2.17569in;" /></a></p>
</div>



    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="2a-7.html" title="6.2.9. DNS DDoS Mitigations for Continued Service" accesskey="p" class="btn btn-primary pull-left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="2a-9.html" title="6.2.11. Remote Triggered Black Holing" accesskey="n" class="btn btn-primary pull-right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
  <script src="../_static/js/bootstrap.min.js"></script>
  <script type="text/javascript">
    jQuery.noConflict(true)
  </script>
  <script src="../_static/js/clouddocs.js"></script>
  </body>
</html>